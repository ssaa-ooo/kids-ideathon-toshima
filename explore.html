<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è±Šå³¶åŒºã®ã€ŒãŠé¡Œã€ã‚’æ¢æ¤œã—ã‚ˆã†ï¼ï½œã¨ã—ã¾ã‚­ãƒƒã‚ºã‚¢ã‚¤ãƒ‡ã‚¢ã‚½ãƒ³</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; color: #333; background-color: #f0f9ff; }
        .adventure-card:hover { transform: scale(1.02) rotate(1deg); transition: all 0.3s ease; }
        .map-bg { background-image: radial-gradient(#cbd5e1 1px, transparent 1px); background-size: 20px 20px; }
        .ai-shimmer { background: linear-gradient(90deg, #eff6ff 25%, #dbeafe 50%, #eff6ff 75%); background-size: 200% 100%; animation: shimmer 1.5s infinite; }
        @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
        #mobile-menu-overlay.active { opacity: 1; pointer-events: auto; }
        #mobile-menu-content.active { transform: translateX(0); }
    </style>
</head>
<body class="antialiased map-bg text-slate-800">

    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-md border-b sticky top-0 z-50">
        <div class="container mx-auto px-4 md:px-6 py-3 flex justify-between items-center text-slate-800">
            <a href="index.html" class="text-base md:text-xl font-black tracking-tighter text-blue-600 leading-none z-50">ã¨ã—ã¾ã‚­ãƒƒã‚º<span class="text-orange-500">ã‚¢ã‚¤ãƒ‡ã‚¢ã‚½ãƒ³</span></a>
            <div class="flex items-center gap-3">
                <a href="explore.html" class="hidden sm:block bg-orange-500 text-white px-3 md:px-4 py-1.5 md:py-2 rounded-full text-xs md:text-sm font-bold shadow-lg hover:bg-orange-600 transition">è¡—ã‚’æ¢æ¤œã—ã¦ã¿ã‚‹</a>
                <button id="menu-btn" class="lg:hidden w-10 h-10 flex flex-col justify-center items-center gap-1.5 z-50 focus:outline-none">
                    <span class="w-6 h-0.5 bg-blue-600 transition-transform duration-300"></span>
                    <span class="w-6 h-0.5 bg-blue-600 transition-opacity duration-300"></span>
                    <span class="w-6 h-0.5 bg-blue-600 transition-transform duration-300"></span>
                </button>
            </div>
        </div>
    </header>

    <div id="mobile-menu-overlay" class="fixed inset-0 bg-blue-900/40 backdrop-blur-sm z-[60] opacity-0 pointer-events-none transition-opacity duration-300 lg:hidden text-slate-800">
        <div id="mobile-menu-content" class="absolute right-0 top-0 h-full w-4/5 max-w-sm bg-white shadow-2xl transform translate-x-full transition-transform duration-300 ease-out flex flex-col p-8 text-slate-800">
            <div class="mt-12 space-y-6">
                <a href="index.html" class="block text-lg font-black border-b pb-4">ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸</a>
                <a href="explore.html" class="block text-lg font-bold text-orange-500">è¡—ã‚’æ¢æ¤œã—ã¦ã¿ã‚‹</a>
            </div>
        </div>
    </div>

    <!-- Hero -->
    <section class="py-12 md:py-20 px-6 text-center text-slate-800">
        <div class="container mx-auto max-w-4xl text-slate-800">
            <span class="inline-block bg-yellow-400 text-yellow-900 px-4 py-1 rounded-full text-xs md:text-sm font-bold mb-6 shadow-sm tracking-wide">MISSION: è¡—ã®ã€ŒãŠé¡Œã€ã‚’è¦‹ã¤ã‘ã‚ˆã†ï¼</span>
            <h1 class="text-3xl md:text-6xl font-black mb-6 md:mb-8 leading-tight text-slate-900">ãã¿ã¯ã€Œè¡—ã®æ¢æ¤œå®¶ã€ã ï¼<br><span class="text-blue-600 italic">Toshima Adventure</span></h1>
            <p class="text-base md:text-xl text-slate-700 mb-8 leading-relaxed font-medium">å¥½ããªã“ã¨ã‚„è¡—ã§è¦‹ã¤ã‘ãŸã“ã¨ã‚’æ•™ãˆã¦ã­ï¼</p>
        </div>
    </section>

    <!-- AI Mentor -->
    <section class="px-6 mb-20 text-slate-800">
        <div class="container mx-auto max-w-3xl text-slate-800">
            <div class="bg-white p-6 md:p-12 rounded-[2.5rem] md:rounded-[3rem] shadow-2xl border-4 border-blue-200 relative overflow-hidden text-slate-800">
                <h2 class="text-xl md:text-3xl font-black mb-6 text-blue-700 flex items-center gap-3"><span>âœ¨</span> AIã‚¢ãƒ‰ãƒ™ãƒ³ãƒãƒ£ãƒ¼ãƒ»ãƒ¡ãƒ³ã‚¿ãƒ¼</h2>
                <div class="space-y-6 text-slate-800">
                    <textarea id="aiInput" class="w-full p-4 border-2 border-slate-200 rounded-2xl focus:border-blue-500 focus:outline-none transition min-h-[120px] text-slate-800 text-sm md:text-base" placeholder="ä¾‹ï¼šã‚¢ãƒ‹ãƒ¡ãŒå¥½ãã€å…¬åœ’ã«ã‚´ãƒŸãŒã‚ã£ãŸã€ãªã©"></textarea>
                    <button id="generateBtn" onclick="generateMission()" class="w-full bg-blue-600 text-white py-4 rounded-2xl font-black text-lg md:text-xl shadow-lg hover:bg-blue-700 transition transform active:scale-95 flex items-center justify-center gap-3">ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’ç”Ÿæˆã™ã‚‹ ğŸš€</button>
                </div>

                <div id="resultArea" class="mt-8 md:mt-10 hidden text-slate-800">
                    <div id="loading" class="ai-shimmer h-32 rounded-2xl flex items-center justify-center font-bold text-blue-600 text-sm md:text-base">æœªæ¥ã‚’ã‚¹ã‚­ãƒ£ãƒ³ä¸­...</div>
                    <div id="missionContent" class="hidden text-slate-800">
                        <div class="bg-orange-50 p-6 rounded-3xl border-2 border-orange-200 text-slate-800">
                            <span class="inline-block bg-orange-500 text-white px-3 py-1 rounded-full text-[10px] font-bold mb-3 uppercase tracking-wider">Your Mission</span>
                            <div id="missionText" class="text-base md:text-lg font-bold text-slate-800 leading-relaxed whitespace-pre-wrap"></div>
                            <div class="mt-6 pt-6 border-t border-orange-200 text-slate-800">
                                <p class="text-xs md:text-sm font-bold text-orange-700 mb-2">ğŸ’¡ ãƒªãƒ¼ãƒ€ãƒ¼ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹</p>
                                <div id="mentorAdvice" class="text-xs md:text-sm text-slate-600 leading-relaxed"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Menu
        const menuBtn = document.getElementById('menu-btn');
        const overlay = document.getElementById('mobile-menu-overlay');
        const content = document.getElementById('mobile-menu-content');
        function toggleMenu() {
            const isActive = content.classList.contains('active');
            if (!isActive) { overlay.classList.add('active'); content.classList.add('active'); }
            else { overlay.classList.remove('active'); content.classList.remove('active'); }
        }
        menuBtn?.addEventListener('click', toggleMenu);

        // AI Logic
        async function generateMission() {
            const input = document.getElementById('aiInput').value;
            if (!input) { alert("æ¢æ¤œã—ãŸã„ã“ã¨ã‚’æ•™ãˆã¦ï¼"); return; }
            const generateBtn = document.getElementById('generateBtn');
            const resultArea = document.getElementById('resultArea');
            const loading = document.getElementById('loading');
            const missionContent = document.getElementById('missionContent');

            generateBtn.disabled = true;
            resultArea.classList.remove('hidden');
            loading.classList.remove('hidden');
            missionContent.classList.add('hidden');

            try {
                // Vercelä¸Šã® /api/mission ã‚’å‘¼ã³å‡ºã™
                const response = await fetch('/api/mission', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ input })
                });

                const result = await response.json();
                if (!response.ok) {
                    throw new Error(result.error || result.detail || 'é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚');
                }

                document.getElementById('missionText').innerText = result.missionTitle + "\n\n" + result.missionDescription;
                document.getElementById('mentorAdvice').innerText = result.advice;
                loading.classList.add('hidden');
                missionContent.classList.remove('hidden');
            } catch (error) {
                console.error("Error:", error);
                alert("AIãƒªãƒ¼ãƒ€ãƒ¼ãŒå°‘ã—ä½œæˆ¦ä¼šè­°ä¸­ã¿ãŸã„ã ï¼š\n" + error.message);
            } finally {
                generateBtn.disabled = false;
            }
        }
    </script>
</body>
</html>
